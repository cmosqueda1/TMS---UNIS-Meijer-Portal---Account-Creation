<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Meijer Portal Account Creator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
:root{
    --bg:#0b1120;
    --panel:#151c2f;
    --card:#1a2340;
    --border:#2a3660;
    --accent:#4c7cff;
    --accent2:#2dd4bf;
    --text:#e7edff;
    --muted:#9aa4c7;
    --error:#ef4444;
    --success:#22c55e;
}

*{
    box-sizing:border-box;
}

html,body{
    margin:0;
    min-height:100vh;
    background:radial-gradient(circle at 15% -15%, #1e2850 0%, transparent 60%),
                linear-gradient(180deg,var(--bg),#04060e);
    color:var(--text);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;
}

.wrapper{
    max-width:780px;
    margin:auto;
    padding:40px 16px;
}

.card{
    background:var(--panel);
    border-radius:20px;
    box-shadow:0 15px 40px rgba(0,0,0,.5);
    border:1px solid var(--border);
    padding:28px;
}

.card h1{
    margin:0 0 6px;
    font-size:1.8rem;
    letter-spacing:.5px;
    background:linear-gradient(90deg,var(--accent),var(--accent2));
    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
}

.subtitle{
    color:var(--muted);
    margin-bottom:20px;
}

.grid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:16px;
}

@media(max-width:640px){
    .grid{
        grid-template-columns:1fr;
    }
}

.field{
    display:flex;
    flex-direction:column;
}

label{
    font-size:.85rem;
    color:var(--muted);
    margin-bottom:6px;
}

input{
    padding:12px 14px;
    border-radius:10px;
    border:1px solid var(--border);
    background:var(--card);
    color:var(--text);
    font-size:15px;
    outline:none;
}

input::placeholder{
    color:#5f6894;
}

input:focus{
    border-color:var(--accent);
}

button{
    margin-top:20px;
    width:100%;
    padding:14px;
    border-radius:12px;
    border:none;
    background:linear-gradient(135deg,var(--accent),var(--accent2));
    color:#fff;
    font-size:16px;
    font-weight:600;
    letter-spacing:.3px;
    cursor:pointer;
    transition:.2s ease;
}

button:hover{
    transform:scale(1.02);
    box-shadow:0 8px 20px rgba(0,0,0,.35);
}

.result{
    margin-top:22px;
    padding:16px;
    border-radius:14px;
    background:#050815;
    border:1px solid var(--border);
    white-space:pre-wrap;
    font-family:ui-monospace, monospace;
    line-height:1.5;
    min-height:120px;
}

.success{
    border-color:var(--success);
}

.error{
    border-color:var(--error);
}

.footer{
    margin-top:10px;
    font-size:.8rem;
    color:var(--muted);
    text-align:center;
}
</style>
</head>

<body>

<div class="wrapper">
<div class="card">

<h1>Meijer TMS Account Creator</h1>
<div class="subtitle">Create and assign portal users using PRO-based vendor mapping</div>

<div class="grid">
  <div class="field">
    <label for="first">First Name</label>
    <input id="first" placeholder="John">
  </div>

  <div class="field">
    <label for="last">Last Name</label>
    <input id="last" placeholder="Smith">
  </div>

  <div class="field">
    <label for="email">Email</label>
    <input id="email" placeholder="user@company.com">
  </div>

  <div class="field">
    <label for="pro">PRO #</label>
    <input id="pro" placeholder="61805217">
  </div>
</div>

<button onclick="runCreate()">Create Account</button>

<div class="result" id="output">Awaiting submission…</div>

<div class="footer">
Uses secure direct TMS API connection – no stored credentials
</div>

</div>
</div>

<script>
async function runCreate(){

    const payload={
        first_name:document.getElementById("first").value.trim(),
        last_name:document.getElementById("last").value.trim(),
        email:document.getElementById("email").value.trim(),
        pro:document.getElementById("pro").value.trim()
    };

    const out=document.getElementById("output");
    out.className="result";
    out.textContent="⏳ Processing account creation...";

    if(!payload.first_name || !payload.last_name || !payload.email || !payload.pro){
        out.className="result error";
        out.textContent="❌ All fields are required.";
        return;
    }

    try{
        const r=await fetch("/api/tms",{
            method:"POST",
            headers:{
                "Content-Type":"application/json"
            },
            body:JSON.stringify(payload)
        });

        const j=await r.json();

        if(j.error){
            out.className="result error";
            out.textContent=
`❌ ACCOUNT CREATION FAILED

${j.error}

${j.body || ""}`;
            return;
        }

        if(j.success){
            out.className="result success";
            out.textContent=
`✅ ACCOUNT CREATED SUCCESSFULLY

Username:
${j.username}

Password:
${j.password}

Vendor Location:
${j.vendor_location_id}

Meijer Location:
${j.meijer_location_id}

User ID:
${j.user_id}

LOGIN:
https://ship.unisco.com/v2/index.html#/login`;

            return;
        }

        out.className="result error";
        out.textContent="Unexpected server reply:\n\n"+JSON.stringify(j,null,2);

    }catch(err){
        out.className="result error";
        out.textContent="❌ Network error: "+err.message;
    }

}
</script>

</body>
</html>
