<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Meijer TMS Account Creator</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
:root{
  --bg:#050b18;
  --panel:#0f172a;
  --border:#1e293b;
  --accent:#4c7cff;
  --accent2:#2dd4bf;
  --text:#e7eeff;
  --muted:#9ca3af;
  --error:#ef4444;
  --success:#22c55e;
}
html,body{
  margin:0;
  min-height:100vh;
  background:radial-gradient(circle at 15% -15%, #1f2e5f 0%, transparent 60%), var(--bg);
  color:var(--text);
  font-family:system-ui,Segoe UI,Arial,sans-serif;
}
.wrapper{
  max-width:820px;
  margin:auto;
  padding:40px 16px;
}
.card{
  background:var(--panel);
  border-radius:20px;
  padding:28px;
  border:1px solid var(--border);
  box-shadow:0 18px 45px rgba(0,0,0,.5);
}
h1{
  margin:0 0 6px;
  background:linear-gradient(90deg,var(--accent),var(--accent2));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.subtitle{
  color:var(--muted);
  margin-bottom:16px;
  font-size:.95rem;
}
.notice{
  border:1px dashed var(--border);
  border-radius:12px;
  padding:12px;
  margin-bottom:18px;
  color:#cbd5f5;
  background:rgba(15,23,42,.4);
}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:16px;
}
@media(max-width:650px){
  .grid{ grid-template-columns:1fr; }
}
.field{
  display:flex;
  flex-direction:column;
}
label{
  font-size:.85rem;
  color:var(--muted);
  margin-bottom:6px;
}
input{
  padding:12px 14px;
  background:#061026;
  border-radius:10px;
  border:1px solid var(--border);
  color:var(--text);
  font-size:15px;
}
input::placeholder{
  color:#64748b;
}
input:focus{
  outline:none;
  border-color:var(--accent);
}
button{
  margin-top:20px;
  padding:14px;
  width:100%;
  border-radius:14px;
  font-size:16px;
  font-weight:600;
  border:none;
  background:linear-gradient(135deg,var(--accent),var(--accent2));
  cursor:pointer;
  color:#fff;
}
button:hover{
  transform:scale(1.01);
}
.result{
  margin-top:22px;
  background:#020617;
  border:1px solid var(--border);
  border-radius:14px;
  padding:16px;
  min-height:140px;
  white-space:pre-wrap;
  font-family:ui-monospace,Consolas,monospace;
}
.success{ border-color:var(--success); }
.error{ border-color:var(--error); }

.footer{
  text-align:center;
  color:var(--muted);
  margin-top:10px;
  font-size:.8rem;
}
</style>
</head>

<body>

<div class="wrapper">
<div class="card">

<h1>Meijer TMS Account Creator</h1>
<div class="subtitle">Create a TMS portal user using PO or PRO mapping</div>

<div class="notice">
<b>You MUST provide:</b><br>
• First Name<br>
• Last Name<br>
• Email<br>
• <b>ONE</b> PO or PRO (either works)
</div>

<div class="grid">
  <div class="field">
    <label>First Name</label>
    <input id="first" placeholder="Chelsea">
  </div>
  <div class="field">
    <label>Last Name</label>
    <input id="last" placeholder="McCormick">
  </div>
  <div class="field">
    <label>Email</label>
    <input id="email" placeholder="wirouting@irisusainc.com">
  </div>
  <div class="field">
    <label>PRO #</label>
    <input id="pro" placeholder="61805217">
  </div>
  <div class="field">
    <label>PO # (optional instead of PRO)</label>
    <input id="po" placeholder="21855674">
  </div>
</div>

<button onclick="submit()">Create Account</button>

<div id="output" class="result">Awaiting submission...</div>

<div class="footer">
Uses secure direct TMS API connection — no stored credentials
</div>

</div>
</div>

<script>
async function submit(){

  const data={
    first_name:first.value.trim(),
    last_name:last.value.trim(),
    email:email.value.trim(),
    pro:pro.value.trim(),
    po:po.value.trim()
  };

  const out=document.getElementById("output");
  out.className="result";
  out.textContent="⏳ Processing...";

  if(!data.first_name || !data.last_name || !data.email){
    out.className="result error";
    out.textContent="❌ First name, last name, and email are required.";
    return;
  }

  if(!data.pro && !data.po){
    out.className="result error";
    out.textContent="❌ You must supply a PO or PRO number.";
    return;
  }

  try{
    const r=await fetch("/api/tms",{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify(data)
    });

    const j=await r.json();

    if(j.error){
      out.className="result error";
      out.textContent=`❌ ${j.error}${j.body ? "\n"+j.body : ""}`;
      return;
    }

    out.className="result success";
    out.textContent=
`✅ ACCOUNT CREATED & LOCATIONS ADDED

USERNAME:
${j.username}

PASSWORD:
${j.password}

VENDOR LOCATION:
${j.vendor_location_id}

MEIJER LOCATION:
${j.meijer_location_id}

USER ID:
${j.user_id}

LOGIN:
https://ship.unisco.com/v2/index.html#/login`;

  }catch(err){
    out.className="result error";
    out.textContent="❌ Network Error: "+err.message;
  }

}
</script>

</body>
</html>
